<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>测试 | outrun的笔记</title>


<link rel="stylesheet" href="/book.min.6c7317d2e8552a0ac3ea8fd4ba500c3dfb1cc9c74e7afd73eee6d729751fad30.css">


<script defer src="/search.min.3a46c391565f1f1bf40fffee740f8e5b6667b86a14536745c93a799cfa884314.js"></script>



<link rel="icon" href="/favicon.png" type="image/x-icon">


<link rel="alternate" type="application/rss+xml" href="https://example.com/docs/test/index.xml" title="outrun的笔记" />
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" style="display: none" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav>
<h2 class="book-brand">
  <a href="https://example.com/">outrun的笔记</a>
</h2>


<div class="book-search">
  <input type="text" placeholder="Search" id="book-search-input" maxlength="64" readonly />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>





    
  
  
  

  <style>
  nav ul a[href$="\2f docs\2ftest\2f "] {
      color: #004ed0;
  }
  </style>

<ul>
<li><a href="/"><strong>介绍</strong></a></li>
<li><a href="/docs/algorithm"><strong>算法</strong></a>

<ul>
<li><a href="/docs/algorithm/math">数学</a></li>
<li><a href="/docs/algorithm/thought">思想</a></li>
<li><a href="/docs/algorithm/data_structure">数据结构</a></li>
</ul></li>
<li><a href="/docs/design"><strong>设计</strong></a>

<ul>
<li><a href="/docs/design/drive">驱动</a></li>
<li><a href="/docs/design/biz">行业</a></li>
<li><a href="/docs/design/organize">组织</a></li>
<li><a href="/docs/design/people">人员</a></li>
<li><a href="/docs/design/project">工程</a></li>
<li><a href="/docs/design/code">代码</a></li>
</ul></li>
<li><a href="/docs/pl"><strong>程序语言</strong></a>

<ul>
<li><a href="/docs/pl/principle">原理</a></li>
<li><a href="/docs/pl/go">go</a></li>
<li><a href="/docs/pl/js">js</a></li>
<li><a href="/docs/pl/java">java</a></li>
<li><a href="/docs/pl/python">python</a></li>
<li><a href="/docs/pl/haskell">haskell</a></li>
<li><a href="/docs/pl/clojure">clojure</a></li>
<li><a href="/docs/pl/markup_language"><strong><em>标记语言</em></strong></a>

<ul>
<li><a href="/docs/pl/markup_language/html">html</a></li>
<li><a href="/docs/pl/markup_language/css">css</a></li>
</ul></li>
</ul></li>
<li><a href="/docs/architecture"><strong>架构</strong></a>

<ul>
<li><a href="/docs/architecture/principle">原理</a></li>
<li><a href="/docs/architecture/performance">性能</a></li>
<li><a href="/docs/architecture/solution">方案</a></li>
<li><a href="/docs/architecture/nginx">nginx</a></li>
<li><a href="/docs/architecture/nodejs">nodejs</a></li>
<li><a href="/docs/architecture/spring_cloud">spring cloud</a></li>
</ul></li>
<li><a href="/docs/backend"><strong>后端</strong></a>

<ul>
<li><a href="/docs/backend/principle">原理</a></li>
<li><a href="/docs/backend/elasticsearch">elasticsearch</a></li>
<li><a href="/docs/backend/javaweb">javaweb</a></li>
<li><a href="/docs/backend/spring">spring</a></li>
<li><a href="/docs/backend/hibernate">hibernate</a></li>
</ul></li>
<li><a href="/docs/db"><strong>数据库</strong></a>

<ul>
<li><a href="/docs/db/mongodb">mongodb</a></li>
<li><a href="/docs/db/mysql">mysql</a></li>
<li><a href="/docs/db/oracle">oracle</a></li>
<li><a href="/docs/db/postgre_sql">pgsql</a></li>
<li><a href="/docs/db/redis">redis</a></li>
</ul></li>
<li><a href="/docs/frontend"><strong>前端</strong></a>

<ul>
<li><a href="/docs/frontend/jquery">jquery</a></li>
<li><a href="/docs/frontend/bootstrap">bootstrap</a></li>
<li><a href="/docs/frontend/angular">angular</a></li>
<li><a href="/docs/frontend/react">react</a></li>
<li><a href="/docs/frontend/threejs">three.js</a></li>
</ul></li>
<li><a href="/docs/ops"><strong>运维</strong></a>

<ul>
<li><a href="/docs/ops/linux">linux</a></li>
<li><a href="/docs/ops/linux_tool">linux工具</a></li>
<li><a href="/docs/ops/security">安全</a></li>
<li><a href="/docs/ops/docker">docker</a></li>
</ul></li>
<li><a href="/docs/test"><strong>测试</strong></a></li>
<li><a href="/docs/tool"><strong>图形工具</strong></a>

<ul>
<li><a href="/docs/tool/vim">vim</a></li>
<li><a href="/docs/tool/eclipse">eclipse</a></li>
</ul></li>
<li><a href="/docs/media">媒体</a></li>
<li><a href="/docs/english">英语</a></li>
<li><a href="/docs/interview">题目</a></li>
<li><a href="/docs/infomation">信息</a></li>
<li><a href="/posts"><strong>博客</strong></a></li>
<li><a href="/about_me">关于我</a></li>
<li><a href="/register">&ldquo;寄存器&rdquo;</a></li>
</ul>







</nav>


<script>
(function() {
  var menu = document.querySelector("aside.book-menu nav");
  addEventListener("beforeunload", function(event) {
    localStorage.setItem("menu.scrollTop", menu.scrollTop);
  });
  menu.scrollTop = localStorage.getItem("menu.scrollTop");
})();
</script>

    </aside>

    <div class="book-page">
      <header class="flex align-center justify-between book-header">
  <label for="menu-control">
    <img src="/svg/menu.svg" alt="Menu" />
  </label>
  <strong>测试</strong>
</header>

      
<article class="markdown">

<h1 id="基础">基础</h1>

<pre><code>分类
    功能测试
        黑盒
        灰盒              # 集成测试阶段，黑盒但关注程序内部
        白盒
    性能测试
        压力测试
        负载测试
        基准测试
            # 统计多少时间内执行了多少次某个方法
    回归测试
        # 改旧代码后，保证旧代码可用
    冒烟测试
        # 功能验证，不一定是改旧代码
前端测试
    structure/behavior(数据结构/行为)问题
        # 判断是否有此耦合，用一个测试验证: 是否为应用逻辑编写一个单元测试而不需要dom结构存在
        ## angular中没有这种问题，因为所有定位元素和处理事件的工作都是在angular内部完成的
        ## 在测试时创建dom，就增加了测试的复杂性。而且页面变化时有更多维护要做。访问dom的操作很慢，测试反馈时间长
</code></pre>

<h1 id="资源占用">资源占用</h1>

<h2 id="cpu">cpu</h2>

<pre><code>graph-frames
subsecond offset
</code></pre>

<h2 id="综合">综合</h2>

<h3 id="visualvm">VisualVM</h3>

<h3 id="jprofiler">JProfiler</h3>

<pre><code># 收费, java
</code></pre>

<h3 id="perfino">perfino</h3>

<pre><code># 监测jvm
</code></pre>

<h3 id="yourkit">YourKit</h3>

<pre><code># 收费, java, 有调用链
</code></pre>

<h3 id="spring-insight">Spring Insight</h3>

<pre><code># java spring
</code></pre>

<h1 id="数据库">数据库</h1>

<pre><code>sysbench
    # mysql 压测
    --db-driver=mysql --mysql-host=visitor-bench.ctysoosgzk4k.rds.cn-north-1.amazonaws.com.cn --mysql-user=root --mysql-password=12345678 --threads=512 --events=1000000 --time=0 --report-interval=15 ./bench_visit_page_insert.lua run
</code></pre>

<h1 id="接口">接口</h1>

<h2 id="loadrunner">loadrunner</h2>

<pre><code>    脚本参数
        get
            web_url(&quot;login&quot;,
                &quot;URL=http://192.168.0.14:9081/ryx-login/sso/login&quot;,
                &quot;Resource=0&quot;,
                &quot;RecContentType=text/html&quot;,
                &quot;Referer=&quot;,
                &quot;Snapshot=t1.inf&quot;,
                &quot;Mode=HTML&quot;,
                EXTRARES,
                &quot;Url=../ycls/img/banner1.jpg&quot;, ENDITEM,
                &quot;Url=../ycls/img/banner2.jpg&quot;, ENDITEM,
                &quot;Url=../ycls/img/banner3.jpg&quot;, ENDITEM,
                &quot;Url=../ycls/img/userinput.png&quot;, ENDITEM,
                &quot;Url=../ycls/img/sawtooth.png&quot;, ENDITEM,
                &quot;Url=../ycls/img/tip2.png&quot;, ENDITEM,
                &quot;Url=../ycls/img/pwdinput.png&quot;, ENDITEM,
                &quot;Url=../ycls/img/login_back.png&quot;, ENDITEM,
                &quot;Url=../ycls/img/tip1.png&quot;, ENDITEM,
                &quot;Url=../ycls/img/codeinput.png&quot;, ENDITEM,
                &quot;Url=../ycls/img/loading-small2.gif&quot;, ENDITEM,
                &quot;Url=/favicon.ico&quot;, &quot;Referer=&quot;, ENDITEM,
                LAST);

        post参数
            web_submit_data(&quot;getActivityParameter&quot;,
                &quot;Action=http://192.168.0.14:9081/tobacco/retail/lottery/getActivityParameter?jsonp=jQuery19109862107675272699_1401335732777&quot;,
                &quot;Method=POST&quot;,
                &quot;RecContentType=text/html&quot;,
                &quot;Referer=http://192.168.0.14:9081/tobacco/retail/index;jsessionid=7BBAFC6DE481FBCB1CB88D738BD7EE71&quot;,
                &quot;Snapshot=t6.inf&quot;,
                &quot;Mode=HTML&quot;,
                ITEMDATA,
                &quot;Name=requestType&quot;, &quot;Value=ajax&quot;, ENDITEM,
                LAST);

        post直接传数据
            web_custom_request(&quot;dataservice&quot;,
                &quot;URL=http://202.110.222.207:7080/rtserver/rest/resource/tobacco/dataservice&quot;,
                &quot;Method=POST&quot;,
                &quot;Resource=0&quot;,
                &quot;RecContentType=text/plain&quot;,
                &quot;Referer=&quot;,
                &quot;Snapshot=t1.inf&quot;,
                &quot;Mode=HTML&quot;,
                &quot;Body= {\&quot;trans_code\&quot;:\&quot;1006\&quot;,\&quot;end_date\&quot;:\&quot;20140701\&quot;,\&quot;source\&quot;:\&quot;appkey\&quot;,\&quot;data\&quot;:\&quot;eyJiZWdpbl9kYXRlIjoiMjAxNDA2MDEiLCJlbmRfZGF0ZSI6IjIwMTQwNzAxIiwicG9zX2lkIjoiODg1MDAzMTAiLCJzb3VyY2UiOiJhcHBrZXkiLCJjdXN0b21lcl9pZCI6IjM3MDExMjEwNzQ2NyIsImFjY2Vzc190b2tlbiI6IiJ9\&quot;,\&quot;begin_date\&quot;:\&quot;20140601\&quot;,\&quot;mac\&quot;:\&quot;123\&quot;,\&quot;pos_id\&quot;:\&quot;88500310\&quot;,\&quot;customer_id\&quot;:\&quot;370112107467\&quot;,\&quot;access_token\&quot;:\&quot;\&quot;}&quot;,
                LAST);
</code></pre>

<h2 id="phoenix">phoenix</h2>

<pre><code>    介绍
            web自动化测试工具
    特点
            分布式执行
            无脚本模式执行
            无人值守模式执行
            自定模式执行
    模块
            数据维护模块
    部署模式
            server-client
                    仅windows下可用
                    socket通信
            web部署
                    server与client放到tomcat或webLogic下部署
                    http通信
                    web页面控制与监控client端执行

wireshark
siege
        siege -c 200 -r 100 http://www.google.com
                # 200并发，发送100次请求
tcpcopy
        # 基于tcp packets的请求复制工具, 在线流量导入到测试系统中
ab
        内网测试, apache自带的压力测试工具, 安装apache后在bin目录中找到
        ab -n1000 -c100 http://www.google.com/a.html
                # 100并发, 发送1000次请求
locust
        # 外网性能测试　
http_load
        # 压测
        http_load -rate 5 -seconds 10 http://www.baidu.com
                # -p 并发
                # -f 总计访问数
                # -r 每秒访问频率
                # -s 总计访问时间
yslow
        # firefox插件，网页性能测试工具
jmeter
        # apache性能测试
gatling
        # dsl脚本, 生成报表
wrk
        # 压测
        wrk -R5000 -d10s &quot;http://internal-rope-api-1875734411.cn-north-1.elb.amazonaws.com.cn/online_agents/1&quot;
swagger
        # 文档与测试用例
fortio
        # istio压测工具
hey
        # http压测
</code></pre>

<h2 id="js">js</h2>

<pre><code>heapdump
        # 堆内存快照
jslint
supertest
        # 测http接口
sinon.js
        # 非运行测试，延时测试等
vows
        # asynchronous BDD(behaviour drven development) for Node
chai
        # js断言
mock.js
        # 模拟生成接口假数据
</code></pre>

<h3 id="benchmark">benchmark</h3>

<pre><code>介绍
        测试代码执行性能
使用
        var Benchmark = require('benchmark');
        var suite = new Benchmark.Suite;

        var int1 = function(str){
                return +str;
        };
        var int2 = function(str){
                return parseInt(str, 10);
        };
        var int3 = function(str){
                return Number(str);
        };
        // 开始测试
        var number = '100';
        suite
        .add('+', function(){
                int1(number);
        });
        .add('parseInt', function(){
                int2(number);
        });
        .add('Number', function(){
                int3(number);
        });
        .on('cycle', function(event){        // 每个测试跑完后输出信息
                console.log(String(event.target));
        })
        .on('complete', function(){
                console.log('Fastest is' + this.filter('fastest').pluck('name'));
        })
        .run({'async': true});                    // 这里async与时间计算有关，默认为true
</code></pre>

<h3 id="travis">travis</h3>

<pre><code>介绍
    项目node版本测试，在基本依赖下跑
使用
    在travis上授权仓库，每当push代码到github, 会自动跑测试
    配置根目录下的.travis.yml文件来配置测试内容，如
        language: node_js
        node_js:
        -'0.8'
        -'0.10'
        -'0.11'
        script: make test
        services:
            mongodb
            # 一个使用了mongodb的nodejs应用，用0.8、0.10、0.11三个版本来跑，跑测试的命令是make test
    travis测试的项目，可以得到一个图片地址，显示项目当前的测试通过状态，把这个图片添加到项目的README中
</code></pre>

<h3 id="jasmine">jasmine</h3>

<pre><code>介绍
    编写单元测试
使用
    describe(&quot;A suite&quot;, function(){
        var foo;
        beforeEach(function(){
                foo = 0;
                foo += 1;
        });
        afterEach(function(){
                foo = 0;
        });
        it(&quot;contains spec with an expectation&quot;, function(){
                expect(true).toBe(true);
        });
    });
</code></pre>

<h3 id="should">should</h3>

<pre><code>介绍
    兼容性测试
安装
    npm install should --save-dev
使用
var should = require('should');

user.should.have.property('name', 'jack')
    # should(user).have.property('name','jack');
user.should.have.property('pets').with.lengthOf(4);
    # 判断数组
should.not.exist(err);
should.exist(result);
result.bar.should.equal(foo);
(5).should.be.exactly(5).and.be.a.Number();
user.should.be.an.instanceOf(Object).and.have.property('name', 'jack');
this.obj.should.have.property('id').which.is.a.Number();
</code></pre>

<h3 id="memwatch">memwatch</h3>

<pre><code>介绍
    监控内存leak, stats,leak在连续5次垃圾回收后内存没释放时触发, stats事件在垃圾回收时触发

o-&gt; 堆内存比较
var memwatch = require('memwatch')
var leakArray = []
var leak = function () {
    leakArray.push('leak' + Math.random())
}
var hd = new memwatch.HeapDiff()
for (var i = 0; i &lt; 10000; i++) {
    leak()
}

var diff = hd.end()
console.log(JSON.stringify(diff, null, 2))
</code></pre>

<h3 id="muk">muk</h3>

<pre><code>var muk = require('muk')
before(function () {
    muk(fs, 'readFileSync', function (path, encoding) {
        throw new Error('mock readFileSync error')
    })
    muk(fs, 'readFile', function (path, encoding, callback) {
        process.nextTick(function () {
            # 模拟异步
            callback(new Error('mock readFile error'))
        })
    })
})

after(function () {
    muk.restore()
})
</code></pre>

<h3 id="rewire">rewire</h3>

<pre><code>介绍
    测试私有方法

o-&gt;
it('limit should return success', function () {
    var lib = rewire('../lib/index.js')
    var litmit = lib.__get__('limit')
    litmit(10).should.be.equal(10)
})
</code></pre>

<h3 id="mocha">mocha</h3>

<pre><code>介绍
    单元测试框架
命令
    mocha
        # --reporters 查看所有报告样式, 默认dot, 常用spec, json, html-cov
        # -R &lt;reporter&gt;采用某报告样式
        # -t &lt;ms&gt;设置超时时间
使用
    npm install -g mocha
    // package.json
    {
        &quot;scripts&quot;: {
            &quot;test&quot;: &quot;mocha test&quot;
            &quot;blanket&quot;: {
                &quot;pattern&quot;: &quot;//^((?!(node_modules|test)).)*$/&quot;,
                &quot;data-cover-flags&quot;: {
                    &quot;debug&quot;: false
                }
            }
        }
    }
    mocha test

o-&gt; bdd风格
describe('Array', function() {
    before(function() {})
        # 钩子函数还有after, beforeEach, afterEach
    it('should return -1 when not present', function (done) {
        [1,2,3].indexOf(4).should.equal(-1)
        this.timeout(500)
            # 500ms后超时
        done()
            # 用done来测试异步
    })
})

o-&gt; bdd风格
suite('Array', function() {
    setup(function () {})
        # 钩子函数还有teardown
    suite('$indexOf()', function () {
        test('should return -1 when not present', function() {
            assert.equal(-1, [1,2,3].indexOf(4))
        })
    })
})
</code></pre>

<h3 id="istanbul">istanbul</h3>

<pre><code>介绍
    名字是依斯坦布尔，用来白盒覆盖用例测试
    支持的use cases有unit tests, browser tests, server side code embedding
使用
    instanbul cover test.js
</code></pre>

<h3 id="phantomjs">phantomjs</h3>

<pre><code>介绍
    前端测试工具
    webkit js测试工具，支持多web标准, dom, css, json, canvas和svg
o-&gt; 使用1
    npm install mocha-phantomjs
    mocha-phantomjs index.html

o-&gt; 使用2
    phantomjs hello.js

    // hello.js
    console.log('Hello, world');
    phantom.exit();
</code></pre>

<h3 id="browserstack">browserstack</h3>

<pre><code>介绍
    前端测试工具
    内建webdriver的api
使用
    npm install browserstack-runner --save-dev
    ./node_modules/.bin/browserstack-runner init
    // browserstack.json
        &quot;test_framework&quot;: &quot;mocha&quot;,
        &quot;timeout&quot;: 60,
        &quot;test_path&quot;: &quot;public/index.html&quot;
    https://www.browserstack.com/accounts/automate
        得到username 和 access key
        复制到browserstack.json中的username和key
    browserstack-runner
    https://www.browserstack.com/automate 查看结果
</code></pre>

<h3 id="karma">karma</h3>

<pre><code>介绍
    是google Testacular的新名字，自动化完成单元测试
使用
    npm install -g karma
    karma start
    karma init
        # 初始化karma配置文件
    npm install karma-jasmine
</code></pre>

<h3 id="jscover">jscover</h3>

<pre><code>介绍
    覆盖率测试
使用
    npm install jscover -g
    jscover lib lib-cov
        # 把lib下的源码编译到lib-cov下，新代码在每一行加上了执行次数统计
    index.js中
        module.exports = process.env.LIB_COV ? require('./lib-cov/index') : require('./lib/index')
    export LIB_COV=1
    mocha -R html-cov &gt; coverage.html
        # 生成结果
</code></pre>

<h3 id="blanket">blanket</h3>

<pre><code>介绍
    比jscover更好的测试工具
使用
    package.json中
        &quot;scripts&quot;: {
            &quot;blanket&quot;: {
                &quot;pattern&quot;: &quot;eventproxy/lib&quot;
                    # 要测试的源码目录
            }
        }
    mocha --require blanket -R html-cov &gt; coverage.html
</code></pre>

<h2 id="python">python</h2>

<pre><code>nose
    # 注解测试
selenium
    # 自动化测试
</code></pre>

<h2 id="go">go</h2>

<pre><code>gomock
    # 官方mock库, 对接口mock
</code></pre>

<h3 id="monkey">monkey</h3>

<pre><code>介绍
    对函数mock
Patch()
Unpatch()
PatchInstanceMethod()
UnpatchInstanceMethod()

问题
    内联函数不能mock
        测试时禁止内联, go test -gcflags=all=&quot;-N -l&quot;
</code></pre>

<h2 id="java">java</h2>

<h3 id="hamcrest">hamcrest</h3>

<pre><code># 自然语法
</code></pre>

<h3 id="mockito">mockito</h3>

<h1 id="页面">页面</h1>

<pre><code>jsperf
    # js性能分析
jasmine
    # js单元测试
</code></pre>

<h1 id="移动">移动</h1>

<pre><code>robotium
    # android自动化测试
</code></pre>
</article>

      
<div class="book-footer justify-between">
  
  <div>
    
    <a href="https://github.com/outrunJ/hugo-blog/commit/921e1cbc545d52464858f27385a71ff10c83a8ff" title='Last modified Sep 24, 2019 by shenwenqing' target="_blank" rel="noopener">
      <img src="/svg/calendar.svg" alt="Changed" /> Sep 24, 2019
    </a>
  </div>
  
  
  <div>
    <a href="https://github.com/outrunJ/hugo-blog/tree/master/content/docs/test/_index.md" target="_blank" rel="noopener">
      <img src="/svg/edit.svg" alt="Edit" /> Edit this page
    </a>
  </div>
  
</div>


      
    </div>

    
  

  <aside class="book-toc level-6 fixed">
    <nav id="TableOfContents">
<ul>
<li><a href="#基础">基础</a></li>
<li><a href="#资源占用">资源占用</a>
<ul>
<li><a href="#cpu">cpu</a></li>
<li><a href="#综合">综合</a>
<ul>
<li><a href="#visualvm">VisualVM</a></li>
<li><a href="#jprofiler">JProfiler</a></li>
<li><a href="#perfino">perfino</a></li>
<li><a href="#yourkit">YourKit</a></li>
<li><a href="#spring-insight">Spring Insight</a></li>
</ul></li>
</ul></li>
<li><a href="#数据库">数据库</a></li>
<li><a href="#接口">接口</a>
<ul>
<li><a href="#loadrunner">loadrunner</a></li>
<li><a href="#phoenix">phoenix</a></li>
<li><a href="#js">js</a>
<ul>
<li><a href="#benchmark">benchmark</a></li>
<li><a href="#travis">travis</a></li>
<li><a href="#jasmine">jasmine</a></li>
<li><a href="#should">should</a></li>
<li><a href="#memwatch">memwatch</a></li>
<li><a href="#muk">muk</a></li>
<li><a href="#rewire">rewire</a></li>
<li><a href="#mocha">mocha</a></li>
<li><a href="#istanbul">istanbul</a></li>
<li><a href="#phantomjs">phantomjs</a></li>
<li><a href="#browserstack">browserstack</a></li>
<li><a href="#karma">karma</a></li>
<li><a href="#jscover">jscover</a></li>
<li><a href="#blanket">blanket</a></li>
</ul></li>
<li><a href="#python">python</a></li>
<li><a href="#go">go</a>
<ul>
<li><a href="#monkey">monkey</a></li>
</ul></li>
<li><a href="#java">java</a>
<ul>
<li><a href="#hamcrest">hamcrest</a></li>
<li><a href="#mockito">mockito</a></li>
</ul></li>
</ul></li>
<li><a href="#页面">页面</a></li>
<li><a href="#移动">移动</a></li>
</ul>
</nav>
  </aside>



  </main>
  
  
  
</body>

</html>
